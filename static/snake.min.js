const c=document.getElementById("gameCanvas"),x=c.getContext("2d"),s=document.getElementById("startBtn"),r=document.getElementById("restartBtn"),o=document.getElementById("score");let d="RIGHT",i=null,t=20;document.addEventListener("keydown",e=>{const n={ArrowUp:"UP",ArrowDown:"DOWN",ArrowLeft:"LEFT",ArrowRight:"RIGHT"};n[e.key]&&(d=n[e.key])});function l(e){x.clearRect(0,0,c.width,c.height),x.fillStyle="lime";for(let[t,e]of e.snake)x.fillRect(t*t,e*t,t-1,t-1);x.fillStyle="red";let[f,l]=e.food;x.fillRect(f*t,l*t,t-1,t-1),o.innerText=`Score: ${e.score}`,e.game_over&&(x.fillStyle="white",x.font="30px Arial",x.fillText("Game Over",c.width/2-70,c.height/2),a(),r.style.display="inline-block")}function u(){fetch("/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({direction:d})}).then(()=>fetch("/state")).then(e=>e.json()).then(l)}function m(){i||(i=setInterval(u,150))}function a(){clearInterval(i),i=null}s.addEventListener("click",()=>{s.style.display="none",m()}),r.addEventListener("click",()=>{fetch("/restart").then(()=>{d="RIGHT",r.style.display="none",m()})});
